!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a){"use strict";var b=a("jquery"),c=a("fastclick"),d=a("./router");window.app.now=new Date,b(function(){c(document.body),window.app.router=new d,window.app.router.start()})},{"./router":4,fastclick:"fastclick",jquery:"jquery"}],2:[function(a,b){"use strict";var c=(a("underscore"),a("backbone"));c.$=a("jquery"),b.exports=c.Collection.extend({url:"/api/terminals",model:a("../models/terminal"),parse:function(a){return a.data}})},{"../models/terminal":3,backbone:"backbone",jquery:"jquery",underscore:"underscore"}],3:[function(a,b){"use strict";var c=(a("underscore"),a("backbone"));c.$=a("jquery"),b.exports=c.Model.extend({urlRoot:"/api/terminals",parse:function(a){return a.data&&a.url?a.data:a}})},{backbone:"backbone",jquery:"jquery",underscore:"underscore"}],4:[function(a,b){"use strict";var c=(a("underscore"),a("backbone")),d=a("jeolok");c.$=a("jquery");{var e,f=a("./views/main"),g=a("./views/header"),h=a("./views/map"),i=a("./collections/terminals");a("./models/terminal")}b.exports=c.Router.extend({views:{},routes:{admin:"showAdminMap","admin/map":"showAdminMap"},start:function(){console.log("AdminRouter:started"),(this.views.main=new f).render(),this.views.main.initAdminHeader((this.views.header=new g).render()),d.getCurrentPosition({enableHighAccuracy:!0,timeout:500},function(a,b){e=a||!b?{latitude:50.84275,longitude:4.35154}:b.coords,window.app.currentPosition=e,c.history.start({pushState:!0})})},showAdminMap:function(){console.log("showAdminMap");var a=this;this.views.main.loading(!0);var b=new i;(this.views.map=new h(b)).collection.fetch({data:{latitude:e.latitude,longitude:e.longitude},success:function(){a.views.main.clearContent(),a.views.main.initAdminMap(a.views.map.render()),a.views.main.loading(!1,"Distributeurs dans un rayon de ")}})}})},{"./collections/terminals":2,"./models/terminal":3,"./views/header":5,"./views/main":6,"./views/map":7,backbone:"backbone",jeolok:"jeolok",jquery:"jquery",underscore:"underscore"}],5:[function(a,b){"use strict";var c=(a("underscore"),a("backbone")),d=a("jquery");c.$=a("jquery");var e;b.exports=c.View.extend({el:"<div />",constructor:function(){c.View.apply(this,arguments),console.log("AdminHeaderView:init()"),e||(e=d("#tpl-header").remove().text())},events:{"click #reload":"reloadButtonClicked"},render:function(){return this.$el.html(e).find("#back").hide().end(),this.$status=this.$el.find("#status h3"),this},loading:function(a){this.$el.find("#status").toggleClass("loading",a)},getStatus:function(){return this.$status.text()},setStatus:function(a){this.$status.text(a)},reloadButtonClicked:function(a){a.preventDefault(),console.log("reloadButtonClicked")}})},{backbone:"backbone",jquery:"jquery",underscore:"underscore"}],6:[function(a,b){"use strict";var c=(a("underscore"),a("backbone")),d=a("jquery");c.$=a("jquery"),b.exports=c.View.extend({el:"body",$el:d("body"),constructor:function(){c.View.apply(this,arguments),console.log("AdminMainView:init()")},loading:function(a,b){a?(this._status=window.app.router.views.header.getStatus(),window.app.router.views.header.loading(!0),window.app.router.views.header.setStatus(b||"chargement...")):(window.app.router.views.header.loading(!1),window.app.router.views.header.setStatus(b))},initAdminHeader:function(a){this.$el.find("#main").append(a.$el)},clearContent:function(){this.$el.find("#main section:not(#status)").remove()},initAdminMap:function(a){this.$el.find("#main").append(a.$el)}})},{backbone:"backbone",jquery:"jquery",underscore:"underscore"}],7:[function(a,b){"use strict";var c=(a("underscore"),a("backbone")),d=a("jquery");c.$=a("jquery");var e,f=a("./terminals");b.exports=c.View.extend({el:"<section />",constructor:function(a){c.View.apply(this,arguments),this.collection=a,console.log("AdminMapView:init()"),e||(e=d("#tpl-list").remove().text())},events:{"click #show":"showList","click #hide":"hideList"},render:function(){return this.$el.html(e),this.create(),this},create:function(){this.collection.each(function(a){var b=a,d=(b.get("bank"),b.get("latitude")),e=b.get("longitude");new google.maps.Marker({position:new google.maps.LatLng(d,e),map:c})});var a=new google.maps.LatLng(50.8459195,4.3648563),b={zoom:10,zoomControl:!0,scrollwheel:!1,center:a,mapTypeId:google.maps.MapTypeId.ROADMAP},c=new google.maps.Map(document.getElementById("gmap"),b)},showList:function(){this.$el.html(e).find("#show").attr("class","hidden").end().find("#hide").attr("class","shown").end().find("ul").attr("class","shown").end();var a=this.$el.find("ul");this.collection.each(function(b){new f(b).render().$el.appendTo(a)})},hideList:function(){this.$el.html(e).find("#show").attr("class","shown").end().find("#hide").attr("class","hidden").end().find("ul").attr("class","hidden").end()}})},{"./terminals":8,backbone:"backbone",jquery:"jquery",underscore:"underscore"}],8:[function(a,b){"use strict";var c=(a("underscore"),a("backbone")),d=a("jquery");c.$=a("jquery");var e;b.exports=c.View.extend({el:"<li />",constructor:function(a){c.View.apply(this,arguments),this.model=a,e||(e=d("#tpl-list-terminals").remove().text())},events:{"click a":"showTerminal"},render:function(){var a=this.model.get("bank");return this.$el.html(e).find(".details").find(".left").find("img").attr("src",a&&a.icon?"/images/banks/"+a.icon:"images/banks/unknown.png").attr("alt",a&&a.name?a.name:"Inconnu").end().find(".name").css("color","#"+(a&&a.color?a.color:"333")).text(a&&a.name?a.name:"Inconnu").end().find("address").css("color","#"+(a&&a.color?a.color:"333")).text(this.model.get("address")).end().end().find(".right").find(".distance").css("color","#"+(a&&a.color?a.color:"333")).text(1e3*parseFloat(this.model.get("distance"))+"m").end().end(),this},showTerminal:function(a){a.preventDefault(),window.app.router.navigate("terminals/details/"+this.model.get("id"),{trigger:!0})}})},{backbone:"backbone",jquery:"jquery",underscore:"underscore"}]},{},[1]);
//# sourceMappingURL=admin.min.js.map